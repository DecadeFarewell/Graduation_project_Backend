webpackJsonp([6],{"+ZmP":function(t,e){},BJW7:function(t,e){},IpPy:function(t,e){},qQKj:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s={props:{dialogVisible:{type:Boolean,required:!0,default:function(){return!1}}},data:function(){return{reader:new FileReader,maxLimit:12,fileObject:[]}},methods:{triggleFile:function(){this.$refs.file.click()},selectedImg:function(t){var e=t.target.files[0];this.fileObject.length>=this.maxLimit?this.execeedLimit():this.addIntoFileObj(e)},execeedLimit:function(){this.$message({message:"选择图片数量不能超过"+this.maxLimit,type:"warning",duration:3500})},addIntoFileObj:function(t){var e=this;this.reader.readAsDataURL(t),this.reader.onload=function(i){var s=i.target.result;e.fileObject.push({url:s,filename:t.name,file:t})}},deleteOne:function(t){this.$refs.file.value=null,this.fileObject.splice(t,1)},subToServer:function(){var t=this.initFormData(),e=this.$store.state.classID;return this.$api.uploadToAlbum(t,e)},initFormData:function(){for(var t=new FormData,e=0;e<this.fileObject.length;e++){var i=this.fileObject[e].file;t.append("img",i)}return t},closeHandle:function(){this.$emit("close")},confirmHandle:function(){var t=this;this.fileObject.length>0?this.subToServer().then(function(e){t.fileObject=[],t.$refs.file.value=null,t.$emit("confirmUpload",!0)}):this.$emit("confirmUpload",!1)},handleClose:function(){var t=this;this.$confirm("确认取消上传？").then(function(e){t.closeHandle()}).catch(function(t){})}}},a={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"upload-dialog-com"},[i("el-dialog",{attrs:{title:"上传图片",visible:t.dialogVisible,width:"75%","before-close":t.handleClose},on:{"update:visible":function(e){t.dialogVisible=e}}},[i("div",{staticClass:"upload-area"},[t._l(t.fileObject,function(e,s){return i("div",{staticClass:"show-local"},[i("div",{staticClass:"img-box"},[i("el-image",{staticClass:"img",attrs:{lazy:"",src:e.url,fit:"contain"}}),t._v(" "),i("div",{staticClass:"delete-bar"},[i("i",{staticClass:"el-icon-delete delete-icon",on:{click:function(e){return t.deleteOne(s)}}})]),t._v(" "),i("span",{staticClass:"file-name"},[t._v(t._s(e.filename))])],1)])}),t._v(" "),t.fileObject.length!==t.maxLimit?i("div",{staticClass:"add-box",on:{click:t.triggleFile}},[i("i",{staticClass:"el-icon-plus add-icon"}),t._v(" "),i("span",{staticClass:"text"},[t._v("上传图片("+t._s(t.fileObject.length)+"/"+t._s(t.maxLimit)+")")]),t._v(" "),i("input",{ref:"file",attrs:{type:"file",hidden:""},on:{change:t.selectedImg}})]):t._e()],2),t._v(" "),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:t.closeHandle}},[t._v("取 消")]),t._v(" "),i("el-button",{attrs:{type:"primary"},on:{click:t.confirmHandle}},[t._v("上 传")])],1)])],1)},staticRenderFns:[]};var l=i("VU/8")(s,a,!1,function(t){i("+ZmP")},"data-v-2a380ad2",null).exports,n={props:{imgPathArr:{type:Array,required:!0,default:function(){return[]}}},computed:{pathObj:function(){var t=this;return this.imgPathArr.map(function(e){var i=e.id,s=e.className,a=e.ctime;return{id:i,className:s,url:t.$url+"/"+e.url,ctime:a}})},completeUrl:function(){var t=[];return this.pathObj.forEach(function(e){t.push(e.url)}),t}},filters:{formatTime:function(t){var e=new Date(1*t),i=e.getFullYear(),s=e.getMonth()+1;s=s<10?"0"+s:s;var a=e.getDate();return i+"-"+s+"-"+(a=a<10?"0"+e.getDate():e.getDate())}}},o={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"images-list-com"},[i("div",{staticClass:"show-box"},[i("div",{staticClass:"images-box"},t._l(t.pathObj,function(e,s){return i("div",{key:e.id,staticClass:"img-item"},[i("el-image",{staticClass:"img",attrs:{lazy:"","preview-src-list":t.completeUrl,src:e.url,fit:"cover"}}),t._v(" "),i("div",{staticClass:"ctime"},[t._v(t._s(t._f("formatTime")(e.ctime)))])],1)}),0)])])},staticRenderFns:[]};var r={components:{DialogUpload:l,ImagesList:i("VU/8")(n,o,!1,function(t){i("IpPy")},"data-v-83b9cd6c",null).exports},data:function(){return{dialogVisible:!1,imgPathArr:[]}},mounted:function(){this.getAlbumImgs()},computed:{isMyClasssAlbum:function(){var t=this.$store.state;return t.classID===t.userInfo.classID}},methods:{confirmUploadHandle:function(t){this.dialogVisible=!1,t&&(this.getAlbumImgs(),this.$message({message:"上传成功！",type:"success"}))},back:function(){console.log(this.$route,"bbbbb"),this.$router.go(-1)},getAlbumImgs:function(){var t=this,e=this.$store.state.classID;this.$api.getAlbumImgsPath({classID:e}).then(function(e){console.log(e,"ppppp"),t.imgPathArr=e.data.data})}}},c={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"album-show-com"},[i("span",{staticClass:"back",on:{click:t.back}},[t._v("返回")]),t._v(" "),t.isMyClasssAlbum?i("div",{staticClass:"upload-img",on:{click:function(e){t.dialogVisible=!0}}},[i("i",{staticClass:"el-icon-picture"}),t._v(" "),i("span",{staticClass:"upload"},[t._v("上传照片")])]):t._e(),t._v(" "),i("DialogUpload",{attrs:{dialogVisible:t.dialogVisible},on:{close:function(e){t.dialogVisible=!1},confirmUpload:t.confirmUploadHandle}}),t._v(" "),i("ImagesList",{attrs:{imgPathArr:t.imgPathArr}})],1)},staticRenderFns:[]};var u=i("VU/8")(r,c,!1,function(t){i("BJW7")},"data-v-2f9a0da3",null);e.default=u.exports}});
//# sourceMappingURL=6.9e3971659617c05f0b78.js.map